{"version":3,"file":"static/js/569.b8907f55.chunk.js","mappings":"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","sources":["components/ItemsFactory.js","components/ItemsFactoryEdit.js","routes/Write.js"],"sourcesContent":["import { dbService, storageService } from \"fbase\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faPlus, faTimes } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\r\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\r\nimport imageCompression from 'browser-image-compression';\r\n\r\nconst ItemFactory = ({ userObj }) => {\r\n  let today = new Date();\r\n  const offset = today.getTimezoneOffset();\r\n  today = new Date(today.getTime() - offset * 60 * 1000);\r\n  const defaultToday = today.toISOString().split(\"T\")[0];\r\n\r\n  useEffect(() => {\r\n    setDate(defaultToday);\r\n  }, []);\r\n\r\n  const navigate = useNavigate();\r\n  const [title, setTitle] = useState(\"오늘의 날씨와 경제\");\r\n  const [date, setDate] = useState(\"\");\r\n  const [low, setLow] = useState(\"\");\r\n  const [high, setHigh] = useState(\"\");\r\n  const [item, setItem] = useState(\"\");\r\n  const [tags, setTags] = useState([]);\r\n  const [attachment, setAttachment] = useState(\"\");\r\n  const [thumbnail, setThumbnail] = useState(\"\");\r\n  const [ext, setExt] = useState(\"\");\r\n\r\n  const onTitleChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setTitle(value);\r\n  };\r\n  const onDateChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setDate(value);\r\n  };\r\n  const onLowChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setLow(value);\r\n  };\r\n  const onHighChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setHigh(value);\r\n  };\r\n  const onSubmit = async (event) => {\r\n    if (item === \"\") {\r\n      return;\r\n    }\r\n    event.preventDefault();\r\n    let attachmentUrl = \"\";\r\n    let thumbnailUrl = \"\";\r\n    if (attachment !== \"\") {\r\n      const attachmentRef = storageService\r\n        .ref()\r\n        .child(`${userObj.uid}/${uuidv4()}${ext ? '.'+ext : '.jpg'}`);\r\n      const response = await attachmentRef.putString(attachment, \"data_url\");\r\n      attachmentUrl = await response.ref.getDownloadURL();\r\n    }\r\n    if (thumbnail !== \"\") {\r\n      const thumbnailRef = storageService\r\n        .ref()\r\n        .child(`thumbnails/${uuidv4()}.webp`);\r\n      const response = await thumbnailRef.putString(thumbnail, \"data_url\");\r\n      thumbnailUrl = await response.ref.getDownloadURL();\r\n    }\r\n    const itemObj = {\r\n      title: title,\r\n      date: date,\r\n      lowestTemp: low,\r\n      highestTemp: high,\r\n      text: item,\r\n      tags: tags,\r\n      createdAt: today.toISOString(),\r\n      creatorId: userObj.uid,\r\n      attachmentUrl,\r\n      thumbnailUrl,\r\n    };\r\n    const docRef = await dbService.collection(\"items\").add(itemObj);\r\n    alert(\"등록 완료!\");\r\n    navigate(`/${docRef.id}`);\r\n  };\r\n  \r\n  const onClearAttachment = () => setAttachment(\"\");\r\n\r\n  async function handleImageUpload(event) {\r\n\r\n    let imageFile = event.target.files[0];\r\n    console.log(`originalFile size ${imageFile.size / 1024 / 1024} MB`);\r\n    if (imageFile.name.indexOf('.') > 0) {\r\n      let ext = imageFile.name.split('.');\r\n      setExt(ext[ext.length - 1]);\r\n    } \r\n\r\n    const options = {\r\n      maxSizeMB: 1,\r\n      maxWidthOrHeight: 1000,\r\n      useWebWorker: true,\r\n      initialQuality: 0.7\r\n    }\r\n    try {\r\n      const compressedFile = await imageCompression(imageFile, options);\r\n      console.log(`compressedFile size ${compressedFile.size / 1024 / 1024} MB`);\r\n      const reader = new FileReader();\r\n      reader.onloadend = (finishedEvent) => {\r\n        const {\r\n          currentTarget: { result },\r\n        } = finishedEvent;\r\n        setAttachment(result);\r\n        \r\n        console.log('Create Thumbnail');\r\n        const width = 300;\r\n        const height = 300;\r\n        const image = new Image();\r\n        image.width = width;\r\n        image.height = height;\r\n        image.title = 'thumbnail';\r\n        image.src = result;\r\n\r\n        image.onload = function () {\r\n          const canvas = document.createElement(\"canvas\");\r\n          canvas.width = width;\r\n          canvas.height = height;\r\n          canvas.getContext(\"2d\").drawImage(image, 0, 0, width, height);\r\n          const dataUri = canvas.toDataURL(\"image/webp\", 0.7);\r\n          setThumbnail(dataUri);\r\n          const thumb = new Image();\r\n          thumb.src=dataUri;\r\n          document.getElementById('thumbnail').appendChild(thumb);\r\n        }\r\n      };\r\n      reader.readAsDataURL(compressedFile);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  \r\n  }\r\n\r\n  const onClickTags = () => {\r\n    if (item === \"\") return;\r\n    const start = item.indexOf(\"#\");\r\n    const tagsOriginal = item.substring(start);\r\n    const result = splitTags(tagsOriginal);\r\n    setTags(result);\r\n  };\r\n\r\n  function splitTags(tagsString) {\r\n    let result = tagsString.replaceAll(\"<p>\", \"\");\r\n    result = result.replaceAll(\"</p>\", \"\");\r\n    result = result.replaceAll(\"#\", \"\");\r\n    result = result.split(\" \");\r\n    return result;\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={onSubmit} className=\"factoryForm\">\r\n      <div className=\"factoryInput__container\">\r\n        <div className=\"factoryInput__title\">\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={title}\r\n            onChange={onTitleChange}\r\n            type=\"text\"\r\n          />\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={date.length > 0 ? date : `${defaultToday}`}\r\n            onChange={onDateChange}\r\n            type=\"date\"\r\n          />\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={low}\r\n            placeholder=\"최저기온\"\r\n            onChange={onLowChange}\r\n            type=\"number\"\r\n          />\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={high}\r\n            placeholder=\"최고기온\"\r\n            onChange={onHighChange}\r\n            type=\"number\"\r\n          />\r\n        </div>\r\n        <CKEditor\r\n          editor={ClassicEditor}\r\n          data=\"\"\r\n          onChange={(event, editor) => {\r\n            const data = editor.getData();\r\n            setItem(data);\r\n          }}\r\n        />\r\n        <div className=\"factoryInput__tag\">\r\n          <input\r\n            className=\"commonBtn formBtn\"\r\n            onClick={onClickTags}\r\n            value=\"Tag 불러오기\"\r\n            type=\"button\"\r\n          />\r\n          {tags.map((tag) => (\r\n            <span className=\"formBtn tagBtn\">{tag}</span>\r\n          ))}\r\n        </div>\r\n        <div className=\"submitBtns\">\r\n          <input\r\n            id=\"news-submit\"\r\n            type=\"submit\"\r\n            value=\"&rarr;\"\r\n            style={{ opacity: 0 }}\r\n          />\r\n          <label htmlFor=\"news-submit\" className=\"factoryInput__arrow\">\r\n            등록\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <label htmlFor=\"attach-file\" className=\"factoryInput__label\">\r\n        <span>사진 첨부</span>\r\n        <FontAwesomeIcon icon={faPlus} />\r\n      </label>\r\n      <input\r\n        id=\"attach-file\"\r\n        type=\"file\"\r\n        accept=\"image/*\"\r\n        onChange={handleImageUpload}\r\n        style={{ opacity: 0 }}\r\n      />\r\n      {attachment && (\r\n        <div className=\"factoryForm__attachment\">\r\n          <img\r\n            src={attachment}\r\n            style={{ backgroundImage: attachment }}\r\n            alt={title}\r\n          />\r\n          <div className=\"factoryForm__clear\" onClick={onClearAttachment}>\r\n            <span>사진 삭제</span>\r\n            <FontAwesomeIcon icon={faTimes} />\r\n          </div>\r\n          <div id=\"thumbnail\"></div>\r\n        </div>\r\n      )}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ItemFactory;\r\n","import { dbService, storageService } from \"fbase\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faPlus, faTimes } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\r\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\r\nimport imageCompression from 'browser-image-compression';\r\n\r\nconst ItemFactoryEdit = ({ userObj, itemId }) => {\r\n  const navigate = useNavigate();\r\n  const [title, setTitle] = useState(\"\");\r\n  const [date, setDate] = useState(\"\");\r\n  const [low, setLow] = useState(\"\");\r\n  const [high, setHigh] = useState(\"\");\r\n  const [item, setItem] = useState(\"\");\r\n  const [tags, setTags] = useState([]);\r\n  const [attachment, setAttachment] = useState(\"\");\r\n  const [thumbnail, setThumbnail] = useState(\"\");\r\n  const [itemObj, setItemObj] = useState(\"\");\r\n  const [ext, setExt] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    dbService\r\n      .doc(`items/${itemId}`)\r\n      .get()\r\n      .then((doc) => {\r\n        const data = doc.data();\r\n        setTitle(data.title);\r\n        setItem(data.text);\r\n        setDate(data.date);\r\n        setLow(data.lowestTemp);\r\n        setHigh(data.highestTemp);\r\n        setTags(data.tags);\r\n        setItemObj(data);\r\n      });\r\n  }, []);\r\n\r\n  const onTitleChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setTitle(value);\r\n  };\r\n  const onDateChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setDate(value);\r\n  };\r\n  const onLowChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setLow(value);\r\n  };\r\n  const onHighChange = (event) => {\r\n    const {\r\n      target: { value },\r\n    } = event;\r\n    setHigh(value);\r\n  };\r\n  const onSubmit = async (event) => {\r\n    if (item === \"\") return alert(\"내용을 입력해 주세요\");\r\n\r\n    event.preventDefault();\r\n    let attachmentUrl = \"\";\r\n    let thumbnailUrl = \"\";\r\n    if (attachment !== \"\") {\r\n      const attachmentRef = storageService\r\n        .ref()\r\n        .child(`${userObj.uid}/${uuidv4()}${ext ? '.'+ext : '.jpg'}`);\r\n      const response = await attachmentRef.putString(attachment, \"data_url\");\r\n      attachmentUrl = await response.ref.getDownloadURL();\r\n    } else {\r\n      attachmentUrl = itemObj.attachmentUrl;\r\n    }\r\n    if (thumbnail !== \"\") {\r\n      const thumbnailRef = storageService\r\n        .ref()\r\n        .child(`thumbnails/${uuidv4()}.webp`);\r\n      const response = await thumbnailRef.putString(thumbnail, \"data_url\");\r\n      thumbnailUrl = await response.ref.getDownloadURL();\r\n    } else {\r\n      thumbnailUrl = itemObj.thumbnailUrl ? itemObj.thumbnailUrl : attachmentUrl;\r\n    }\r\n\r\n    const newItemObj = {\r\n      title: title,\r\n      date: date,\r\n      lowestTemp: low,\r\n      highestTemp: high,\r\n      text: item,\r\n      tags: tags,\r\n      createdAt: itemObj.createdAt,\r\n      creatorId: itemObj.creatorId,\r\n      attachmentUrl,\r\n      thumbnailUrl,\r\n    };\r\n\r\n    await dbService.doc(`items/${itemId}`).update(newItemObj);\r\n    alert(\"수정 완료!\");\r\n    navigate(`/${itemId}`);\r\n  };\r\n\r\n  async function handleImageUpload(event) {\r\n\r\n    let imageFile = event.target.files[0];\r\n    console.log(`originalFile size ${imageFile.size / 1024 / 1024} MB`);\r\n    if (imageFile.name.indexOf('.') > 0) {\r\n      let ext = imageFile.name.split('.');\r\n      setExt(ext[ext.length - 1]);\r\n    } \r\n\r\n    const options = {\r\n      maxSizeMB: 1,\r\n      maxWidthOrHeight: 1000,\r\n      useWebWorker: true,\r\n      initialQuality: 0.7\r\n    }\r\n    try {\r\n      const compressedFile = await imageCompression(imageFile, options);\r\n      console.log(`compressedFile size ${compressedFile.size / 1024 / 1024} MB`);\r\n      const reader = new FileReader();\r\n      reader.onloadend = (finishedEvent) => {\r\n        const {\r\n          currentTarget: { result },\r\n        } = finishedEvent;\r\n        setAttachment(result);\r\n\r\n        console.log('Create Thumbnail');\r\n        // create thumbnail\r\n        const width = 300;\r\n        const height = 300;\r\n        const image = new Image();\r\n        image.width = width;\r\n        image.height = height;\r\n        image.title = 'thumbnail';\r\n        image.src = result;\r\n\r\n        image.onload = function () {\r\n          const canvas = document.createElement(\"canvas\");\r\n          canvas.width = width;\r\n          canvas.height = height;\r\n          canvas.getContext(\"2d\").drawImage(image, 0, 0, width, height);\r\n          const dataUri = canvas.toDataURL(\"image/webp\", 0.7);\r\n          setThumbnail(dataUri);\r\n          const thumb = new Image();\r\n          thumb.src=dataUri;\r\n          document.getElementById('thumbnail').appendChild(thumb);\r\n        }\r\n      };\r\n      reader.readAsDataURL(compressedFile);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  \r\n  }\r\n\r\n  const onClearAttachment = () => setAttachment(\"\");\r\n  const onDeleteClick = async () => {\r\n    const ok = window.confirm(\"삭제하시겠습니까?\");\r\n    if (ok) {\r\n      await dbService.doc(`items/${itemId}`).update({\r\n        attachmentUrl: \"\",\r\n        thumbnailUrl: \"\",\r\n      });\r\n      await storageService.refFromURL(itemObj.attachmentUrl).delete();\r\n      await storageService.refFromURL(itemObj.thumbnailUrl).delete();\r\n      alert(\"사진 삭제 완료!\");\r\n      navigate(`/write/${itemId}`);\r\n    }\r\n  };\r\n\r\n  const onClickTags = () => {\r\n    if (item === \"\") return;\r\n    const start = item.indexOf(\"#\");\r\n    const tagsOriginal = item.substring(start);\r\n    const result = splitTags(tagsOriginal);\r\n    setTags(result);\r\n  };\r\n\r\n  function splitTags(tagsString) {\r\n    let result = tagsString.replaceAll(\"<p>\", \"\");\r\n    result = result.replaceAll(\"</p>\", \"\");\r\n    result = result.replaceAll(\"#\", \"\");\r\n    result = result.split(\" \");\r\n    return result;\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={onSubmit} className=\"factoryForm\">\r\n      <div className=\"factoryInput__container\">\r\n        <div className=\"factoryInput__title\">\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={title}\r\n            onChange={onTitleChange}\r\n            type=\"text\"\r\n          />\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={date}\r\n            onChange={onDateChange}\r\n            type=\"date\"\r\n          />\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={low}\r\n            placeholder=\"최저기온\"\r\n            onChange={onLowChange}\r\n            type=\"number\"\r\n          />\r\n          <input\r\n            className=\"factoryInput__Input\"\r\n            value={high}\r\n            placeholder=\"최고기온\"\r\n            onChange={onHighChange}\r\n            type=\"number\"\r\n          />\r\n        </div>\r\n\r\n        <CKEditor\r\n          editor={ClassicEditor}\r\n          data={itemObj.text}\r\n          onChange={(event, editor) => {\r\n            const data = editor.getData();\r\n            setItem(data);\r\n          }}\r\n        />\r\n        <div className=\"factoryInput__tag\">\r\n          <input\r\n            className=\"commonBtn formBtn\"\r\n            onClick={onClickTags}\r\n            value=\"Tag 불러오기\"\r\n            type=\"button\"\r\n          />\r\n          {tags.map((tag) => (\r\n            <span className=\"formBtn tagBtn\">{tag}</span>\r\n          ))}\r\n        </div>\r\n        <div className=\"submitBtns\">\r\n          <input\r\n            id=\"news-submit\"\r\n            type=\"submit\"\r\n            value=\"&rarr;\"\r\n            style={{ opacity: 0 }}\r\n          />\r\n          <label htmlFor=\"news-submit\" className=\"factoryInput__arrow\">\r\n            수정\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <label htmlFor=\"attach-file\" className=\"factoryInput__label\">\r\n        <span>사진 첨부</span>\r\n        <FontAwesomeIcon icon={faPlus} />\r\n      </label>\r\n      <input\r\n        id=\"attach-file\"\r\n        type=\"file\"\r\n        accept=\"image/*\"\r\n        onChange={handleImageUpload}\r\n        style={{ opacity: 0 }}\r\n      />\r\n      <div className=\"factoryForm__attachment\">\r\n        {attachment && (\r\n          <>\r\n            <img\r\n              src={attachment}\r\n              style={{ backgroundImage: attachment }}\r\n              alt={itemObj.title}\r\n            />\r\n            <div className=\"factoryForm__clear\" onClick={onClearAttachment}>\r\n              <span>사진 삭제</span>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </div>\r\n          </>\r\n        )}\r\n        {itemObj.attachmentUrl && (\r\n          <>\r\n            <img src={itemObj.attachmentUrl} alt={itemObj.title} />\r\n            <div className=\"factoryForm__clear\" onClick={onDeleteClick}>\r\n              <span>기존 사진 삭제</span>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ItemFactoryEdit;\r\n","import ItemFactory from \"components/ItemsFactory\";\r\nimport ItemFactoryEdit from \"components/ItemsFactoryEdit\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nconst Write = ({ userObj }) => {\r\n  let { id } = useParams();\r\n\r\n  return (\r\n    <section className=\"wrapContainer dark\">\r\n      <div className=\"container\">\r\n        {id ? (\r\n          <>\r\n            <h2>글 수정하기</h2>\r\n            <ItemFactoryEdit userObj={userObj} itemId={id} />\r\n          </>\r\n        ) : (\r\n          <>\r\n            <h2>새 글 등록하기</h2>\r\n            <ItemFactory userObj={userObj} />\r\n          </>\r\n        )}\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Write;\r\n"],"names":["userObj","today","Date","offset","getTimezoneOffset","defaultToday","getTime","toISOString","split","useEffect","setDate","navigate","useNavigate","useState","title","setTitle","date","low","setLow","high","setHigh","item","setItem","tags","setTags","attachment","setAttachment","thumbnail","setThumbnail","ext","setExt","onSubmit","event","preventDefault","attachmentUrl","thumbnailUrl","attachmentRef","storageService","child","uid","uuidv4","putString","response","ref","getDownloadURL","thumbnailRef","itemObj","lowestTemp","highestTemp","text","createdAt","creatorId","dbService","add","docRef","alert","id","imageFile","target","files","console","log","size","name","indexOf","length","options","maxSizeMB","maxWidthOrHeight","useWebWorker","initialQuality","imageCompression","compressedFile","reader","FileReader","onloadend","finishedEvent","result","currentTarget","image","Image","width","height","src","onload","canvas","document","createElement","getContext","drawImage","dataUri","toDataURL","thumb","getElementById","appendChild","readAsDataURL","className","value","onChange","type","placeholder","CKEditor","editor","ClassicEditor","data","getData","onClick","start","tagsString","replaceAll","splitTags","substring","map","tag","style","opacity","htmlFor","icon","faPlus","accept","backgroundImage","alt","faTimes","itemId","setItemObj","get","then","doc","newItemObj","update","onDeleteClick","window","confirm","delete","useParams"],"sourceRoot":""}
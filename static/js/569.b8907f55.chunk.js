"use strict";(self.webpackChunkweaco=self.webpackChunkweaco||[]).push([[569],{1569:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var n=a(5861),r=a(9439),s=a(7757),c=a.n(s),i=a(1248),l=a(2791),u=a(6871),o=a(2810),p=a(4483),m=a(3174),d=a(7551),h=a(2443),f=a.n(h),x=a(7984),g=a(184),v=function(e){var t=e.userObj,a=new Date,s=a.getTimezoneOffset(),h=(a=new Date(a.getTime()-60*s*1e3)).toISOString().split("T")[0];(0,l.useEffect)((function(){C(h)}),[]);var v=(0,u.s0)(),j=(0,l.useState)("\uc624\ub298\uc758 \ub0a0\uc528\uc640 \uacbd\uc81c"),b=(0,r.Z)(j,2),y=b[0],w=b[1],_=(0,l.useState)(""),I=(0,r.Z)(_,2),N=I[0],C=I[1],S=(0,l.useState)(""),k=(0,r.Z)(S,2),Z=k[0],U=k[1],F=(0,l.useState)(""),B=(0,r.Z)(F,2),O=B[0],T=B[1],D=(0,l.useState)(""),R=(0,r.Z)(D,2),z=R[0],A=R[1],L=(0,l.useState)([]),E=(0,r.Z)(L,2),H=E[0],M=E[1],W=(0,l.useState)(""),G=(0,r.Z)(W,2),K=G[0],Q=G[1],q=(0,l.useState)(""),J=(0,r.Z)(q,2),P=J[0],V=J[1],X=(0,l.useState)(""),Y=(0,r.Z)(X,2),$=Y[0],ee=Y[1],te=function(){var e=(0,n.Z)(c().mark((function e(n){var r,s,l,u,p,m,d,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==z){e.next=2;break}return e.abrupt("return");case 2:if(n.preventDefault(),r="",s="",""===K){e.next=13;break}return l=i.Hw.ref().child("".concat(t.uid,"/").concat((0,o.Z)()).concat($?"."+$:".jpg")),e.next=9,l.putString(K,"data_url");case 9:return u=e.sent,e.next=12,u.ref.getDownloadURL();case 12:r=e.sent;case 13:if(""===P){e.next=21;break}return p=i.Hw.ref().child("thumbnails/".concat((0,o.Z)(),".webp")),e.next=17,p.putString(P,"data_url");case 17:return m=e.sent,e.next=20,m.ref.getDownloadURL();case 20:s=e.sent;case 21:return d={title:y,date:N,lowestTemp:Z,highestTemp:O,text:z,tags:H,createdAt:a.toISOString(),creatorId:t.uid,attachmentUrl:r,thumbnailUrl:s},e.next=24,i.wO.collection("items").add(d);case 24:h=e.sent,alert("\ub4f1\ub85d \uc644\ub8cc!"),v("/".concat(h.id));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ae(){return(ae=(0,n.Z)(c().mark((function e(t){var a,n,r,s,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files[0],console.log("originalFile size ".concat(a.size/1024/1024," MB")),a.name.indexOf(".")>0&&(n=a.name.split("."),ee(n[n.length-1])),r={maxSizeMB:1,maxWidthOrHeight:1e3,useWebWorker:!0,initialQuality:.7},e.prev=4,e.next=7,(0,x.Z)(a,r);case 7:s=e.sent,console.log("compressedFile size ".concat(s.size/1024/1024," MB")),(i=new FileReader).onloadend=function(e){var t=e.currentTarget.result;Q(t),console.log("Create Thumbnail");var a=new Image;a.width=300,a.height=300,a.title="thumbnail",a.src=t,a.onload=function(){var e=document.createElement("canvas");e.width=300,e.height=300,e.getContext("2d").drawImage(a,0,0,300,300);var t=e.toDataURL("image/webp",.7);V(t);var n=new Image;n.src=t,document.getElementById("thumbnail").appendChild(n)}},i.readAsDataURL(s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})))).apply(this,arguments)}return(0,g.jsxs)("form",{onSubmit:te,className:"factoryForm",children:[(0,g.jsxs)("div",{className:"factoryInput__container",children:[(0,g.jsxs)("div",{className:"factoryInput__title",children:[(0,g.jsx)("input",{className:"factoryInput__Input",value:y,onChange:function(e){var t=e.target.value;w(t)},type:"text"}),(0,g.jsx)("input",{className:"factoryInput__Input",value:N.length>0?N:"".concat(h),onChange:function(e){var t=e.target.value;C(t)},type:"date"}),(0,g.jsx)("input",{className:"factoryInput__Input",value:Z,placeholder:"\ucd5c\uc800\uae30\uc628",onChange:function(e){var t=e.target.value;U(t)},type:"number"}),(0,g.jsx)("input",{className:"factoryInput__Input",value:O,placeholder:"\ucd5c\uace0\uae30\uc628",onChange:function(e){var t=e.target.value;T(t)},type:"number"})]}),(0,g.jsx)(d.CKEditor,{editor:f(),data:"",onChange:function(e,t){var a=t.getData();A(a)}}),(0,g.jsxs)("div",{className:"factoryInput__tag",children:[(0,g.jsx)("input",{className:"commonBtn formBtn",onClick:function(){if(""!==z){var e=z.indexOf("#"),t=function(e){var t=e.replaceAll("<p>","");return t=(t=(t=t.replaceAll("</p>","")).replaceAll("#","")).split(" ")}(z.substring(e));M(t)}},value:"Tag \ubd88\ub7ec\uc624\uae30",type:"button"}),H.map((function(e){return(0,g.jsx)("span",{className:"formBtn tagBtn",children:e})}))]}),(0,g.jsxs)("div",{className:"submitBtns",children:[(0,g.jsx)("input",{id:"news-submit",type:"submit",value:"\u2192",style:{opacity:0}}),(0,g.jsx)("label",{htmlFor:"news-submit",className:"factoryInput__arrow",children:"\ub4f1\ub85d"})]})]}),(0,g.jsxs)("label",{htmlFor:"attach-file",className:"factoryInput__label",children:[(0,g.jsx)("span",{children:"\uc0ac\uc9c4 \ucca8\ubd80"}),(0,g.jsx)(p.G,{icon:m.r8p})]}),(0,g.jsx)("input",{id:"attach-file",type:"file",accept:"image/*",onChange:function(e){return ae.apply(this,arguments)},style:{opacity:0}}),K&&(0,g.jsxs)("div",{className:"factoryForm__attachment",children:[(0,g.jsx)("img",{src:K,style:{backgroundImage:K},alt:y}),(0,g.jsxs)("div",{className:"factoryForm__clear",onClick:function(){return Q("")},children:[(0,g.jsx)("span",{children:"\uc0ac\uc9c4 \uc0ad\uc81c"}),(0,g.jsx)(p.G,{icon:m.NBC})]}),(0,g.jsx)("div",{id:"thumbnail"})]})]})},j=function(e){var t=e.userObj,a=e.itemId,s=(0,u.s0)(),h=(0,l.useState)(""),v=(0,r.Z)(h,2),j=v[0],b=v[1],y=(0,l.useState)(""),w=(0,r.Z)(y,2),_=w[0],I=w[1],N=(0,l.useState)(""),C=(0,r.Z)(N,2),S=C[0],k=C[1],Z=(0,l.useState)(""),U=(0,r.Z)(Z,2),F=U[0],B=U[1],O=(0,l.useState)(""),T=(0,r.Z)(O,2),D=T[0],R=T[1],z=(0,l.useState)([]),A=(0,r.Z)(z,2),L=A[0],E=A[1],H=(0,l.useState)(""),M=(0,r.Z)(H,2),W=M[0],G=M[1],K=(0,l.useState)(""),Q=(0,r.Z)(K,2),q=Q[0],J=Q[1],P=(0,l.useState)(""),V=(0,r.Z)(P,2),X=V[0],Y=V[1],$=(0,l.useState)(""),ee=(0,r.Z)($,2),te=ee[0],ae=ee[1];(0,l.useEffect)((function(){i.wO.doc("items/".concat(a)).get().then((function(e){var t=e.data();b(t.title),R(t.text),I(t.date),k(t.lowestTemp),B(t.highestTemp),E(t.tags),Y(t)}))}),[]);var ne=function(){var e=(0,n.Z)(c().mark((function e(n){var r,l,u,p,m,d,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==D){e.next=2;break}return e.abrupt("return",alert("\ub0b4\uc6a9\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694"));case 2:if(n.preventDefault(),r="",l="",""===W){e.next=15;break}return u=i.Hw.ref().child("".concat(t.uid,"/").concat((0,o.Z)()).concat(te?"."+te:".jpg")),e.next=9,u.putString(W,"data_url");case 9:return p=e.sent,e.next=12,p.ref.getDownloadURL();case 12:r=e.sent,e.next=16;break;case 15:r=X.attachmentUrl;case 16:if(""===q){e.next=26;break}return m=i.Hw.ref().child("thumbnails/".concat((0,o.Z)(),".webp")),e.next=20,m.putString(q,"data_url");case 20:return d=e.sent,e.next=23,d.ref.getDownloadURL();case 23:l=e.sent,e.next=27;break;case 26:l=X.thumbnailUrl?X.thumbnailUrl:r;case 27:return h={title:j,date:_,lowestTemp:S,highestTemp:F,text:D,tags:L,createdAt:X.createdAt,creatorId:X.creatorId,attachmentUrl:r,thumbnailUrl:l},e.next=30,i.wO.doc("items/".concat(a)).update(h);case 30:alert("\uc218\uc815 \uc644\ub8cc!"),s("/".concat(a));case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function re(){return(re=(0,n.Z)(c().mark((function e(t){var a,n,r,s,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files[0],console.log("originalFile size ".concat(a.size/1024/1024," MB")),a.name.indexOf(".")>0&&(n=a.name.split("."),ae(n[n.length-1])),r={maxSizeMB:1,maxWidthOrHeight:1e3,useWebWorker:!0,initialQuality:.7},e.prev=4,e.next=7,(0,x.Z)(a,r);case 7:s=e.sent,console.log("compressedFile size ".concat(s.size/1024/1024," MB")),(i=new FileReader).onloadend=function(e){var t=e.currentTarget.result;G(t),console.log("Create Thumbnail");var a=new Image;a.width=300,a.height=300,a.title="thumbnail",a.src=t,a.onload=function(){var e=document.createElement("canvas");e.width=300,e.height=300,e.getContext("2d").drawImage(a,0,0,300,300);var t=e.toDataURL("image/webp",.7);J(t);var n=new Image;n.src=t,document.getElementById("thumbnail").appendChild(n)}},i.readAsDataURL(s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})))).apply(this,arguments)}var se=function(){var e=(0,n.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){e.next=10;break}return e.next=4,i.wO.doc("items/".concat(a)).update({attachmentUrl:"",thumbnailUrl:""});case 4:return e.next=6,i.Hw.refFromURL(X.attachmentUrl).delete();case 6:return e.next=8,i.Hw.refFromURL(X.thumbnailUrl).delete();case 8:alert("\uc0ac\uc9c4 \uc0ad\uc81c \uc644\ub8cc!"),s("/write/".concat(a));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)("form",{onSubmit:ne,className:"factoryForm",children:[(0,g.jsxs)("div",{className:"factoryInput__container",children:[(0,g.jsxs)("div",{className:"factoryInput__title",children:[(0,g.jsx)("input",{className:"factoryInput__Input",value:j,onChange:function(e){var t=e.target.value;b(t)},type:"text"}),(0,g.jsx)("input",{className:"factoryInput__Input",value:_,onChange:function(e){var t=e.target.value;I(t)},type:"date"}),(0,g.jsx)("input",{className:"factoryInput__Input",value:S,placeholder:"\ucd5c\uc800\uae30\uc628",onChange:function(e){var t=e.target.value;k(t)},type:"number"}),(0,g.jsx)("input",{className:"factoryInput__Input",value:F,placeholder:"\ucd5c\uace0\uae30\uc628",onChange:function(e){var t=e.target.value;B(t)},type:"number"})]}),(0,g.jsx)(d.CKEditor,{editor:f(),data:X.text,onChange:function(e,t){var a=t.getData();R(a)}}),(0,g.jsxs)("div",{className:"factoryInput__tag",children:[(0,g.jsx)("input",{className:"commonBtn formBtn",onClick:function(){if(""!==D){var e=D.indexOf("#"),t=function(e){var t=e.replaceAll("<p>","");return t=(t=(t=t.replaceAll("</p>","")).replaceAll("#","")).split(" ")}(D.substring(e));E(t)}},value:"Tag \ubd88\ub7ec\uc624\uae30",type:"button"}),L.map((function(e){return(0,g.jsx)("span",{className:"formBtn tagBtn",children:e})}))]}),(0,g.jsxs)("div",{className:"submitBtns",children:[(0,g.jsx)("input",{id:"news-submit",type:"submit",value:"\u2192",style:{opacity:0}}),(0,g.jsx)("label",{htmlFor:"news-submit",className:"factoryInput__arrow",children:"\uc218\uc815"})]})]}),(0,g.jsxs)("label",{htmlFor:"attach-file",className:"factoryInput__label",children:[(0,g.jsx)("span",{children:"\uc0ac\uc9c4 \ucca8\ubd80"}),(0,g.jsx)(p.G,{icon:m.r8p})]}),(0,g.jsx)("input",{id:"attach-file",type:"file",accept:"image/*",onChange:function(e){return re.apply(this,arguments)},style:{opacity:0}}),(0,g.jsxs)("div",{className:"factoryForm__attachment",children:[W&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("img",{src:W,style:{backgroundImage:W},alt:X.title}),(0,g.jsxs)("div",{className:"factoryForm__clear",onClick:function(){return G("")},children:[(0,g.jsx)("span",{children:"\uc0ac\uc9c4 \uc0ad\uc81c"}),(0,g.jsx)(p.G,{icon:m.NBC})]})]}),X.attachmentUrl&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("img",{src:X.attachmentUrl,alt:X.title}),(0,g.jsxs)("div",{className:"factoryForm__clear",onClick:se,children:[(0,g.jsx)("span",{children:"\uae30\uc874 \uc0ac\uc9c4 \uc0ad\uc81c"}),(0,g.jsx)(p.G,{icon:m.NBC})]})]})]})]})},b=function(e){var t=e.userObj,a=(0,u.UO)().id;return(0,g.jsx)("section",{className:"wrapContainer dark",children:(0,g.jsx)("div",{className:"container",children:a?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h2",{children:"\uae00 \uc218\uc815\ud558\uae30"}),(0,g.jsx)(j,{userObj:t,itemId:a})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h2",{children:"\uc0c8 \uae00 \ub4f1\ub85d\ud558\uae30"}),(0,g.jsx)(v,{userObj:t})]})})})}}}]);
//# sourceMappingURL=569.b8907f55.chunk.js.map